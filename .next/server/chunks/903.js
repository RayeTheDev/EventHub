exports.id=903,exports.ids=[903],exports.modules={97877:(e,t,a)=>{let r={"08b1bfd02b76933c3b24a69e7b920590bb132057":()=>Promise.resolve().then(a.bind(a,24743)).then(e=>e.getRelatedEventsByCategory),"23778a59fc7fa27ccb1a7e3364e4f0f7732a1148":()=>Promise.resolve().then(a.bind(a,24743)).then(e=>e.deleteEvent),"54a4be3ccd96d48882f975399b07ef76463dd2ff":()=>Promise.resolve().then(a.bind(a,24743)).then(e=>e.getEventsByUser),"7472731b3cd46b677e496c747760d6f2b0e33aad":()=>Promise.resolve().then(a.bind(a,24743)).then(e=>e.updateEvent),"9b01a2c5bb077c3f1c3637b13dec9bd1c8248af9":()=>Promise.resolve().then(a.bind(a,24743)).then(e=>e.getAllEvents),"9e7dffa4eafba31016bb13cedd905f2fe6576d78":()=>Promise.resolve().then(a.bind(a,24743)).then(e=>e.createEvent),d8fd5746a788e9d4cb4f935970016760422124b1:()=>Promise.resolve().then(a.bind(a,24743)).then(e=>e.getEventById)};async function n(e,...t){return(await r[e]()).apply(null,t)}e.exports={"08b1bfd02b76933c3b24a69e7b920590bb132057":n.bind(null,"08b1bfd02b76933c3b24a69e7b920590bb132057"),"23778a59fc7fa27ccb1a7e3364e4f0f7732a1148":n.bind(null,"23778a59fc7fa27ccb1a7e3364e4f0f7732a1148"),"54a4be3ccd96d48882f975399b07ef76463dd2ff":n.bind(null,"54a4be3ccd96d48882f975399b07ef76463dd2ff"),"7472731b3cd46b677e496c747760d6f2b0e33aad":n.bind(null,"7472731b3cd46b677e496c747760d6f2b0e33aad"),"9b01a2c5bb077c3f1c3637b13dec9bd1c8248af9":n.bind(null,"9b01a2c5bb077c3f1c3637b13dec9bd1c8248af9"),"9e7dffa4eafba31016bb13cedd905f2fe6576d78":n.bind(null,"9e7dffa4eafba31016bb13cedd905f2fe6576d78"),d8fd5746a788e9d4cb4f935970016760422124b1:n.bind(null,"d8fd5746a788e9d4cb4f935970016760422124b1")}},48835:(e,t,a)=>{"use strict";a.r(t),a.d(t,{DeleteConfirmation:()=>c});var r=a(95344),n=a(3729),i=a(8428),d=a(89410),s=a(86262),l=a(31826);let c=({eventId:e})=>{let t=(0,i.usePathname)(),[a,c]=(0,n.useTransition)();return(0,r.jsxs)(s.aR,{children:[r.jsx(s.vW,{children:r.jsx(d.default,{src:"/assets/icons/delete.svg",alt:"edit",width:20,height:20})}),(0,r.jsxs)(s._T,{className:"bg-white",children:[(0,r.jsxs)(s.fY,{children:[r.jsx(s.f$,{children:"Are you sure you want to delete?"}),r.jsx(s.yT,{className:"p-regular-16 text-grey-600",children:"This will permanently delete this event"})]}),(0,r.jsxs)(s.xo,{children:[r.jsx(s.le,{children:"Cancel"}),r.jsx(s.OL,{onClick:()=>c(async()=>{await (0,l.Bt)({eventId:e,path:t})}),children:a?"Deleting...":"Delete"})]})]})]})}},62349:(e,t,a)=>{"use strict";a.d(t,{Z:()=>u});var r=a(25036);a(40002);var n=a(95752),i=a(93183),d=a(2813),s=a(16274),l=a(86843);let c=(0,l.createProxy)(String.raw`/Users/raye/Documents/Codes/EventHub/components/shared/DeleteConfirmation.tsx`),{__esModule:o,$$typeof:f}=c;c.default;let b=(0,l.createProxy)(String.raw`/Users/raye/Documents/Codes/EventHub/components/shared/DeleteConfirmation.tsx#DeleteConfirmation`),m=({event:e,hasOrderLink:t,hidePrice:a})=>{let{sessionClaims:l}=(0,i.I8)(),c=l?.userId===e.organizer._id.toString();return(0,r.jsxs)("div",{className:"group relative flex min-h-[380px] w-full max-w-[400px] flex-col overflow-hidden rounded-xl bg-white shadow-md transition-all hover:shadow-lg md:min-h-[438px]",children:[r.jsx(s.default,{href:`/events/${e._id}`,style:{backgroundImage:`url(${e.imageUrl})`},className:"flex-center flex-grow bg-gray-50 bg-cover bg-center text-grey-500"}),c&&!a&&(0,r.jsxs)("div",{className:"absolute right-2 top-2 flex flex-col gap-4 rounded-xl bg-white p-3 shadow-sm transition-all",children:[r.jsx(s.default,{href:`/events/${e._id}/update`,children:r.jsx(d.default,{src:"/assets/icons/edit.svg",alt:"edit",width:20,height:20})}),r.jsx(b,{eventId:e._id})]}),(0,r.jsxs)("div",{className:"flex min-h-[230px] flex-col gap-3 p-5 md:gap-4",children:[!a&&(0,r.jsxs)("div",{className:"flex gap-2",children:[r.jsx("span",{className:"p-semibold-14 w-min rounded-full bg-green-100 px-4 py-1 text-green-60",children:e.isFree?"FREE":`$${e.price}`}),r.jsx("p",{className:"p-semibold-14 w-min rounded-full bg-grey-500/10 px-4 py-1 text-grey-500 line-clamp-1",children:e.category.name})]}),r.jsx("p",{className:"p-medium-16 p-medium-18 text-grey-500",children:(0,n.o0)(e.startDateTime).dateTime}),r.jsx(s.default,{href:`/events/${e._id}`,children:r.jsx("p",{className:"p-medium-16 md:p-medium-20 line-clamp-2 flex-1 text-black",children:e.title})}),(0,r.jsxs)("div",{className:"flex-between w-full",children:[(0,r.jsxs)("p",{className:"p-medium-14 md:p-medium-16 text-grey-600",children:[e.organizer.firstName," ",e.organizer.lastName]}),t&&(0,r.jsxs)(s.default,{href:`/orders?eventId=${e._id}`,className:"flex gap-2",children:[r.jsx("p",{className:"text-primary-500",children:"Order Details"}),r.jsx(d.default,{src:"/assets/icons/arrow.svg",alt:"search",width:10,height:10})]})]})]})]})},u=({data:e,emptyTitle:t,emptyStateSubtext:a,page:n,totalPages:i=0,collectionType:d,urlParamName:s})=>r.jsx(r.Fragment,{children:e.length>0?r.jsx("div",{className:"flex flex-col items-center gap-10",children:r.jsx("ul",{className:"grid w-full grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-3 xl:gap-10",children:e.map(e=>r.jsx("li",{className:"flex justify-center",children:r.jsx(m,{event:e,hasOrderLink:"Events_Organized"===d,hidePrice:"My_Tickets"===d})},e._id))})}):(0,r.jsxs)("div",{className:"flex-center wrapper min-h-[200px] w-full flex-col gap-3 rounded-[14px] bg-grey-50 py-28 text-center",children:[r.jsx("h3",{className:"p-bold-20 md:h5-bold",children:t}),r.jsx("p",{className:"p-regular-14",children:a})]})})},24743:(e,t,a)=>{"use strict";a.r(t),a.d(t,{createEvent:()=>g,deleteEvent:()=>y,getAllEvents:()=>x,getEventById:()=>h,getEventsByUser:()=>v,getRelatedEventsByCategory:()=>w,updateEvent:()=>p});var r=a(74471);a(68616);var n=a(66864),i=a(47730),d=a(78485),s=a(50751),l=a(11185);let c=new l.Schema({name:{type:String,required:!0,unique:!0}}),o=l.models.Category||(0,l.model)("Category",c);var f=a(95752),b=a(42053);let m=async e=>o.findOne({name:{$regex:e,$options:"i"}}),u=e=>e.populate({path:"organizer",model:s.Z,select:"_id firstName lastName"}).populate({path:"category",model:o,select:"_id name"});async function g({userId:e,event:t,path:a}){try{if(await (0,i.v)(),!await s.Z.findById(e))throw Error("Organizer not found");let r=await d.Z.create({...t,category:t.categoryId,organizer:e});return(0,n.revalidatePath)(a),JSON.parse(JSON.stringify(r))}catch(e){(0,f.S3)(e)}}async function h(e){try{await (0,i.v)();let t=await u(d.Z.findById(e));if(!t)throw Error("Event not found");return JSON.parse(JSON.stringify(t))}catch(e){(0,f.S3)(e)}}async function p({userId:e,event:t,path:a}){try{await (0,i.v)();let r=await d.Z.findById(t._id);if(!r||r.organizer.toHexString()!==e)throw Error("Unauthorized or event not found");let s=await d.Z.findByIdAndUpdate(t._id,{...t,category:t.categoryId},{new:!0});return(0,n.revalidatePath)(a),JSON.parse(JSON.stringify(s))}catch(e){(0,f.S3)(e)}}async function y({eventId:e,path:t}){try{await (0,i.v)(),await d.Z.findByIdAndDelete(e)&&(0,n.revalidatePath)(t)}catch(e){(0,f.S3)(e)}}async function x({query:e,limit:t=6,page:a,category:r}){try{await (0,i.v)();let n=r?await m(r):null,s={$and:[e?{title:{$regex:e,$options:"i"}}:{},n?{category:n._id}:{}]},l=(Number(a)-1)*t,c=d.Z.find(s).sort({createdAt:"desc"}).skip(l).limit(t),o=await u(c),f=await d.Z.countDocuments(s);return{data:JSON.parse(JSON.stringify(o)),totalPages:Math.ceil(f/t)}}catch(e){(0,f.S3)(e)}}async function v({userId:e,limit:t=6,page:a}){try{await (0,i.v)();let r={organizer:e},n=d.Z.find(r).sort({createdAt:"desc"}).skip((a-1)*t).limit(t),s=await u(n),l=await d.Z.countDocuments(r);return{data:JSON.parse(JSON.stringify(s)),totalPages:Math.ceil(l/t)}}catch(e){(0,f.S3)(e)}}async function w({categoryId:e,eventId:t,limit:a=3,page:r=1}){try{await (0,i.v)();let n=(Number(r)-1)*a,s={$and:[{category:e},{_id:{$ne:t}}]},l=d.Z.find(s).sort({createdAt:"desc"}).skip(n).limit(a),c=await u(l),o=await d.Z.countDocuments(s);return{data:JSON.parse(JSON.stringify(c)),totalPages:Math.ceil(o/a)}}catch(e){(0,f.S3)(e)}}(0,b.h)([g,h,p,y,x,v,w]),(0,r.U)("9e7dffa4eafba31016bb13cedd905f2fe6576d78",g),(0,r.U)("d8fd5746a788e9d4cb4f935970016760422124b1",h),(0,r.U)("7472731b3cd46b677e496c747760d6f2b0e33aad",p),(0,r.U)("23778a59fc7fa27ccb1a7e3364e4f0f7732a1148",y),(0,r.U)("9b01a2c5bb077c3f1c3637b13dec9bd1c8248af9",x),(0,r.U)("54a4be3ccd96d48882f975399b07ef76463dd2ff",v),(0,r.U)("08b1bfd02b76933c3b24a69e7b920590bb132057",w)},47730:(e,t,a)=>{"use strict";a.d(t,{v:()=>s});var r=a(11185),n=a.n(r);let i=process.env.MONGODB_URI,d=global.mongoose||{conn:null,promise:null},s=async()=>{if(d.conn)return d.conn;if(!i)throw Error("MONGODB_URI is missing");return d.promise=d.promise||n().connect(i,{dbName:"EventHub",bufferCommands:!1}),d.con=await d.promise,d.conn}},78485:(e,t,a)=>{"use strict";a.d(t,{Z:()=>i});var r=a(11185);let n=new r.Schema({title:{type:String,required:!0},description:{type:String},location:{type:String},createdAt:{type:Date,default:Date.now()},imageUrl:{type:String,required:!0},startDateTime:{type:Date,default:Date.now()},endDateTime:{type:Date,default:Date.now()},price:{type:String,required:!0},isFree:{type:Boolean,required:!0},url:{type:String},category:{type:r.Schema.Types.ObjectId,ref:"Category"},organizer:{type:r.Schema.Types.ObjectId,ref:"User"}}),i=r.models.Event||(0,r.model)("Event",n)},50751:(e,t,a)=>{"use strict";a.d(t,{Z:()=>i});var r=a(11185);let n=new r.Schema({clerkId:{type:String,required:!0,unique:!0},email:{type:String,required:!0,unique:!0},username:{type:String,required:!0,unique:!0},firstName:{type:String,required:!0},lastName:{type:String,required:!0},photo:{type:String,required:!0}}),i=r.models.User||(0,r.model)("User",n)}};