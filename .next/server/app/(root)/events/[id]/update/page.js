(()=>{var e={};e.id=624,e.ids=[624],e.modules={11185:e=>{"use strict";e.exports=require("mongoose")},47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},72254:e=>{"use strict";e.exports=require("node:buffer")},6005:e=>{"use strict";e.exports=require("node:crypto")},87561:e=>{"use strict";e.exports=require("node:fs")},88849:e=>{"use strict";e.exports=require("node:http")},22286:e=>{"use strict";e.exports=require("node:https")},87503:e=>{"use strict";e.exports=require("node:net")},49411:e=>{"use strict";e.exports=require("node:path")},97742:e=>{"use strict";e.exports=require("node:process")},84492:e=>{"use strict";e.exports=require("node:stream")},72477:e=>{"use strict";e.exports=require("node:stream/web")},41041:e=>{"use strict";e.exports=require("node:url")},47261:e=>{"use strict";e.exports=require("node:util")},65628:e=>{"use strict";e.exports=require("node:zlib")},71017:e=>{"use strict";e.exports=require("path")},77282:e=>{"use strict";e.exports=require("process")},57310:e=>{"use strict";e.exports=require("url")},71267:e=>{"use strict";e.exports=require("worker_threads")},92677:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>s.a,__next_app__:()=>p,originalPathname:()=>l,pages:()=>u,routeModule:()=>b,tree:()=>c});var a=r(50482),n=r(69108),i=r(62563),s=r.n(i),d=r(68300),o={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>d[e]);r.d(t,o);let c=["",{children:["(root)",{children:["events",{children:["[id]",{children:["update",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,26181)),"/Users/raye/Documents/Codes/EventHub/app/(root)/events/[id]/update/page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,61108)),"/Users/raye/Documents/Codes/EventHub/app/(root)/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,69361,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,57481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,82917)),"/Users/raye/Documents/Codes/EventHub/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,69361,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,57481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],u=["/Users/raye/Documents/Codes/EventHub/app/(root)/events/[id]/update/page.tsx"],l="/(root)/events/[id]/update/page",p={require:r,loadChunk:()=>Promise.resolve()},b=new a.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/(root)/events/[id]/update/page",pathname:"/events/[id]/update",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},12580:(e,t,r)=>{let a={"960be520f86855c948aaea9e568d0be7e99fe927":()=>Promise.resolve().then(r.bind(r,97681)).then(e=>e.createCategory),c552ed714e725e5024cb18334c474428491b8208:()=>Promise.resolve().then(r.bind(r,97681)).then(e=>e.getAllCategory)};async function n(e,...t){return(await a[e]()).apply(null,t)}e.exports={"960be520f86855c948aaea9e568d0be7e99fe927":n.bind(null,"960be520f86855c948aaea9e568d0be7e99fe927"),c552ed714e725e5024cb18334c474428491b8208:n.bind(null,"c552ed714e725e5024cb18334c474428491b8208")}},97877:(e,t,r)=>{let a={"08b1bfd02b76933c3b24a69e7b920590bb132057":()=>Promise.resolve().then(r.bind(r,24743)).then(e=>e.getRelatedEventsByCategory),"23778a59fc7fa27ccb1a7e3364e4f0f7732a1148":()=>Promise.resolve().then(r.bind(r,24743)).then(e=>e.deleteEvent),"54a4be3ccd96d48882f975399b07ef76463dd2ff":()=>Promise.resolve().then(r.bind(r,24743)).then(e=>e.getEventsByUser),"7472731b3cd46b677e496c747760d6f2b0e33aad":()=>Promise.resolve().then(r.bind(r,24743)).then(e=>e.updateEvent),"9b01a2c5bb077c3f1c3637b13dec9bd1c8248af9":()=>Promise.resolve().then(r.bind(r,24743)).then(e=>e.getAllEvents),"9e7dffa4eafba31016bb13cedd905f2fe6576d78":()=>Promise.resolve().then(r.bind(r,24743)).then(e=>e.createEvent),d8fd5746a788e9d4cb4f935970016760422124b1:()=>Promise.resolve().then(r.bind(r,24743)).then(e=>e.getEventById)};async function n(e,...t){return(await a[e]()).apply(null,t)}e.exports={"08b1bfd02b76933c3b24a69e7b920590bb132057":n.bind(null,"08b1bfd02b76933c3b24a69e7b920590bb132057"),"23778a59fc7fa27ccb1a7e3364e4f0f7732a1148":n.bind(null,"23778a59fc7fa27ccb1a7e3364e4f0f7732a1148"),"54a4be3ccd96d48882f975399b07ef76463dd2ff":n.bind(null,"54a4be3ccd96d48882f975399b07ef76463dd2ff"),"7472731b3cd46b677e496c747760d6f2b0e33aad":n.bind(null,"7472731b3cd46b677e496c747760d6f2b0e33aad"),"9b01a2c5bb077c3f1c3637b13dec9bd1c8248af9":n.bind(null,"9b01a2c5bb077c3f1c3637b13dec9bd1c8248af9"),"9e7dffa4eafba31016bb13cedd905f2fe6576d78":n.bind(null,"9e7dffa4eafba31016bb13cedd905f2fe6576d78"),d8fd5746a788e9d4cb4f935970016760422124b1:n.bind(null,"d8fd5746a788e9d4cb4f935970016760422124b1")}},26181:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var a=r(25036),n=r(23274),i=r(24743),s=r(93183);let d=async({params:{id:e}})=>{let{sessionClaims:t}=(0,s.I8)(),r=t?.userId,d=await (0,i.getEventById)(e);return(0,a.jsxs)(a.Fragment,{children:[a.jsx("section",{className:"bg-primary-50 bg-dotted-pattern bg-cover bg-center py-5 md:py-10",children:a.jsx("h3",{className:"wrapper h3-bold text-center sm:text-left",children:"Update Event"})}),a.jsx("div",{className:"wrapper my-8",children:a.jsx(n.ZP,{type:"Update",event:d,eventId:d._id,userId:r})})]})}},24743:(e,t,r)=>{"use strict";r.r(t),r.d(t,{createEvent:()=>y,deleteEvent:()=>v,getAllEvents:()=>h,getEventById:()=>m,getEventsByUser:()=>x,getRelatedEventsByCategory:()=>q,updateEvent:()=>g});var a=r(74471);r(68616);var n=r(66864),i=r(47730),s=r(78485),d=r(50751),o=r(11185);let c=new o.Schema({name:{type:String,required:!0,unique:!0}}),u=o.models.Category||(0,o.model)("Category",c);var l=r(95752),p=r(42053);let b=async e=>u.findOne({name:{$regex:e,$options:"i"}}),f=e=>e.populate({path:"organizer",model:d.Z,select:"_id firstName lastName"}).populate({path:"category",model:u,select:"_id name"});async function y({userId:e,event:t,path:r}){try{if(await (0,i.v)(),!await d.Z.findById(e))throw Error("Organizer not found");let a=await s.Z.create({...t,category:t.categoryId,organizer:e});return(0,n.revalidatePath)(r),JSON.parse(JSON.stringify(a))}catch(e){(0,l.S3)(e)}}async function m(e){try{await (0,i.v)();let t=await f(s.Z.findById(e));if(!t)throw Error("Event not found");return JSON.parse(JSON.stringify(t))}catch(e){(0,l.S3)(e)}}async function g({userId:e,event:t,path:r}){try{await (0,i.v)();let a=await s.Z.findById(t._id);if(!a||a.organizer.toHexString()!==e)throw Error("Unauthorized or event not found");let d=await s.Z.findByIdAndUpdate(t._id,{...t,category:t.categoryId},{new:!0});return(0,n.revalidatePath)(r),JSON.parse(JSON.stringify(d))}catch(e){(0,l.S3)(e)}}async function v({eventId:e,path:t}){try{await (0,i.v)(),await s.Z.findByIdAndDelete(e)&&(0,n.revalidatePath)(t)}catch(e){(0,l.S3)(e)}}async function h({query:e,limit:t=6,page:r,category:a}){try{await (0,i.v)();let n=a?await b(a):null,d={$and:[e?{title:{$regex:e,$options:"i"}}:{},n?{category:n._id}:{}]},o=(Number(r)-1)*t,c=s.Z.find(d).sort({createdAt:"desc"}).skip(o).limit(t),u=await f(c),l=await s.Z.countDocuments(d);return{data:JSON.parse(JSON.stringify(u)),totalPages:Math.ceil(l/t)}}catch(e){(0,l.S3)(e)}}async function x({userId:e,limit:t=6,page:r}){try{await (0,i.v)();let a={organizer:e},n=s.Z.find(a).sort({createdAt:"desc"}).skip((r-1)*t).limit(t),d=await f(n),o=await s.Z.countDocuments(a);return{data:JSON.parse(JSON.stringify(d)),totalPages:Math.ceil(o/t)}}catch(e){(0,l.S3)(e)}}async function q({categoryId:e,eventId:t,limit:r=3,page:a=1}){try{await (0,i.v)();let n=(Number(a)-1)*r,d={$and:[{category:e},{_id:{$ne:t}}]},o=s.Z.find(d).sort({createdAt:"desc"}).skip(n).limit(r),c=await f(o),u=await s.Z.countDocuments(d);return{data:JSON.parse(JSON.stringify(c)),totalPages:Math.ceil(u/r)}}catch(e){(0,l.S3)(e)}}(0,p.h)([y,m,g,v,h,x,q]),(0,a.U)("9e7dffa4eafba31016bb13cedd905f2fe6576d78",y),(0,a.U)("d8fd5746a788e9d4cb4f935970016760422124b1",m),(0,a.U)("7472731b3cd46b677e496c747760d6f2b0e33aad",g),(0,a.U)("23778a59fc7fa27ccb1a7e3364e4f0f7732a1148",v),(0,a.U)("9b01a2c5bb077c3f1c3637b13dec9bd1c8248af9",h),(0,a.U)("54a4be3ccd96d48882f975399b07ef76463dd2ff",x),(0,a.U)("08b1bfd02b76933c3b24a69e7b920590bb132057",q)},47730:(e,t,r)=>{"use strict";r.d(t,{v:()=>d});var a=r(11185),n=r.n(a);let i=process.env.MONGODB_URI,s=global.mongoose||{conn:null,promise:null},d=async()=>{if(s.conn)return s.conn;if(!i)throw Error("MONGODB_URI is missing");return s.promise=s.promise||n().connect(i,{dbName:"EventHub",bufferCommands:!1}),s.con=await s.promise,s.conn}},78485:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var a=r(11185);let n=new a.Schema({title:{type:String,required:!0},description:{type:String},location:{type:String},createdAt:{type:Date,default:Date.now()},imageUrl:{type:String,required:!0},startDateTime:{type:Date,default:Date.now()},endDateTime:{type:Date,default:Date.now()},price:{type:String,required:!0},isFree:{type:Boolean,required:!0},url:{type:String},category:{type:a.Schema.Types.ObjectId,ref:"Category"},organizer:{type:a.Schema.Types.ObjectId,ref:"User"}}),i=a.models.Event||(0,a.model)("Event",n)},50751:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var a=r(11185);let n=new a.Schema({clerkId:{type:String,required:!0,unique:!0},email:{type:String,required:!0,unique:!0},username:{type:String,required:!0,unique:!0},firstName:{type:String,required:!0},lastName:{type:String,required:!0},photo:{type:String,required:!0}}),i=a.models.User||(0,a.model)("User",n)}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[638,457,387,987,345,556,222,431,92,373],()=>r(92677));module.exports=a})();